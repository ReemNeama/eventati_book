# Messaging & Vendor Communication Component Diagram

This document provides a detailed breakdown of the messaging and vendor communication components in the Eventati Book application.

## Messaging & Vendor Communication Components Overview

```
┌─────────────────────────────────────────────────────────────────────────┐
│                MESSAGING & VENDOR COMMUNICATION SYSTEM                  │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                ┌───────────────────┼───────────────────┐
                │                   │                   │
                ▼                   ▼                   ▼
┌───────────────────────┐ ┌───────────────────┐ ┌───────────────────────┐
│     UI COMPONENTS     │ │  STATE MANAGEMENT │ │     DATA LAYER        │
│                       │ │                   │ │                        │
│  ┌─────────────────┐  │ │ ┌─────────────┐   │ │  ┌─────────────────┐  │
│  │VendorListScreen │  │ │ │Messaging    │   │ │  │ Vendor Model    │  │
│  └────────┬────────┘  │ │ │Provider     │   │ │  └────────┬────────┘  │
│           │           │ │ └──────┬──────┘   │ │           │           │
│  ┌────────▼────────┐  │ │        │          │ │  ┌────────▼────────┐  │
│  │Conversation     │──┼─┼────────┼──────────┼─┼──┤ Message Model   │  │
│  │Screen           │  │ │        │          │ │  └────────┬────────┘  │
│           │           │ │        │          │ │           │           │
│           │           │ │        │          │ │  ┌────────▼────────┐  │
│           │           │ │        │          │ │  │ Conversation    │  │
│           │           │ │        │          │ │  │ Model           │  │
│           │           │ │        │          │ │  └────────┬────────┘  │
│           │           │ │        │          │ │           │           │
│           │           │ │        │          │ │  ┌────────▼────────┐  │
│           │           │ │        │          │ │  │ TempDB/Firebase │  │
│           │           │ │        │          │ │  └─────────────────┘  │
│                       │ │                   │ │                       │
└───────────────────────┘ └───────────────────┘ └───────────────────────┘
```

## Messaging & Vendor Communication UI Components

### VendorListScreen
```
┌─────────────────────────────────────────────────────────────────────────┐
│                       VENDOR LIST SCREEN                                │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           HEADER                                        │
│                                                                         │
│  ┌─────────────┐  ┌─────────────────────────────────┐                   │
│  │  Back       │  │  Vendor Communication           │                   │
│  │  Button     │  │                                 │                   │
│  └─────────────┘  └─────────────────────────────────┘                   │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           SEARCH BAR                                    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Search vendors...                                              │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           VENDOR LIST                                   │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Vendor Card                                                    │    │
│  │  - Vendor Name                                                  │    │
│  │  - Service Type                                                 │    │
│  │  - Last Message Preview                                         │    │
│  │  - Last Message Time                                            │    │
│  │  - Unread Message Indicator                                     │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Vendor Card                                                    │    │
│  │  ...                                                            │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────┘
```

### ConversationScreen
```
┌─────────────────────────────────────────────────────────────────────────┐
│                       CONVERSATION SCREEN                               │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           HEADER                                        │
│                                                                         │
│  ┌─────────────┐  ┌─────────────────────────────────┐                   │
│  │  Back       │  │  Vendor Name                    │                   │
│  │  Button     │  │                                 │                   │
│  └─────────────┘  └─────────────────────────────────┘                   │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           MESSAGE LIST                                  │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Date Separator                                                 │    │
│  │  - Date: January 15, 2023                                       │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Message Bubble (Vendor)                                        │    │
│  │  - Message Content                                              │    │
│  │  - Timestamp                                                    │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  Message Bubble (User)                                          │    │
│  │  - Message Content                                              │    │
│  │  - Timestamp                                                    │    │
│  │  - Read Status Indicator                                        │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           MESSAGE INPUT                                 │
│                                                                         │
│  ┌─────────────────────────────────────────────────┐  ┌─────────────┐   │
│  │  Type a message...                              │  │  Send       │   │
│  └─────────────────────────────────────────────────┘  │  Button     │   │
│                                                       └─────────────┘   │
└─────────────────────────────────────────────────────────────────────────┘
```

## Messaging & Vendor Communication Data Models

### Vendor Model
```
┌─────────────────────────────────────────────────────────────────────────┐
│                           VENDOR MODEL                                  │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           PROPERTIES                                    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String id                                                      │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String name                                                    │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String serviceType                                             │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String? email                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String? phone                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String? contactPerson                                          │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String? notes                                                  │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────┘
```

### Message Model
```
┌─────────────────────────────────────────────────────────────────────────┐
│                           MESSAGE MODEL                                 │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           PROPERTIES                                    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String id                                                      │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String vendorId                                                │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String content                                                 │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  DateTime timestamp                                             │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  bool isFromUser                                                │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  List<String>? attachments                                      │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  bool isRead                                                    │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────┘
```

### Conversation Model
```
┌─────────────────────────────────────────────────────────────────────────┐
│                           CONVERSATION MODEL                            │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           PROPERTIES                                    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  String vendorId                                                │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  List<Message> messages                                         │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  DateTime lastMessageTime                                       │    │
│  └─────────────────────────────────────────────────────────────────┘    │
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐    │
│  │  bool hasUnreadMessages                                         │    │
│  └─────────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────────┘
```

## Component Interactions

### Viewing Vendor Conversations
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │
│  Event      │────▶│ VendorList  │────▶│ Messaging   │
│  Planning   │     │ Screen      │     │ Provider    │
│  Tools      │     │             │     │ vendors     │
│             │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
```

### Opening a Conversation
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │     │             │
│  VendorList │────▶│Conversation │────▶│ Messaging   │────▶│ Conversation│
│  Screen     │     │ Screen      │     │ Provider    │     │ Screen      │
│             │     │             │     │getMessages  │     │ (loaded)    │
│             │     │             │     │ForVendor()  │     │             │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
```

### Sending a Message
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │     │             │
│Conversation │────▶│ MessageInput│────▶│ Messaging   │────▶│ Conversation│
│ Screen      │     │             │     │ Provider    │     │ Screen      │
│             │     │             │     │sendMessage()│     │ (updated)   │
│             │     │             │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
```

### Marking Messages as Read
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │
│Conversation │────▶│ Messaging   │────▶│ VendorList  │
│ Screen      │     │ Provider    │     │ Screen      │
│ (open)      │     │markMessages │     │ (updated)   │
│             │     │AsRead()     │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
```

## Integration with Other Features

### Integration with Event Planning
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │
│  Event      │────▶│ Planning    │────▶│ VendorList  │
│  Dashboard  │     │ Tools Screen│     │ Screen      │
│             │     │             │     │             │
│             │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
```

### Integration with Service Booking
```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│             │     │             │     │             │
│  Service    │────▶│  Booking    │────▶│  Messaging  │
│  Booking    │     │  Provider   │     │  Provider   │
│  Screen     │     │             │     │             │
│             │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
```

## Messaging & Vendor Communication Widget Dependencies

```
┌─────────────────────────────────────────────────────────────────────────┐
│                 MESSAGING & VENDOR COMMUNICATION WIDGETS                │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────┐
│                           CUSTOM WIDGETS                                │
│                                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐    │
│  │ VendorCard  │  │ MessageBubble│ │ MessageInput│  │ DateSeparator│   │
│  │             │  │             │  │             │  │             │    │
│  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘    │
│                                                                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                     │
│  │ EmptyState  │  │ SearchBar   │  │ ReadStatus  │                     │
│  │             │  │             │  │ Indicator   │                     │
│  └─────────────┘  └─────────────┘  └─────────────┘                     │
└─────────────────────────────────────────────────────────────────────────┘
```

## Future Firebase Implementation

When Firebase is implemented, the messaging and vendor communication system will use Firebase Firestore:

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       FIREBASE MESSAGING STORAGE                        │
└───────────────────────────────────┬─────────────────────────────────────┘
                                    │
                ┌───────────────────┼───────────────────┐
                │                   │                   │
                ▼                   ▼                   ▼
┌───────────────────────┐ ┌───────────────────┐ ┌───────────────────────┐
│  VENDOR COLLECTION    │ │  MESSAGE COLLECTION│ │  EVENT COLLECTION     │
│                       │ │                   │ │                        │
│  - Vendor documents   │ │  - Message docs   │ │  - Event documents    │
│  - Contact info       │ │  - Read status    │ │  - Vendor refs        │
│  - Service details    │ │  - Attachments    │ │  - Event metadata     │
└───────────────────────┘ └───────────────────┘ └───────────────────────┘
```
